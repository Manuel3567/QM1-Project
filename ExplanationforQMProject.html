<html><head><meta content="text/html; charset=UTF-8" http-equiv="content-type"><style type="text/css">@import url('https://themes.googleusercontent.com/fonts/css?kit=fpjTOVmNbO4Lz34iLyptLUXza5VhXqVC6o75Eld_V98');ol.lst-kix_list_1-3{list-style-type:none}ol.lst-kix_list_1-4{list-style-type:none}ol.lst-kix_list_1-5{list-style-type:none}ol.lst-kix_list_1-6{list-style-type:none}ol.lst-kix_list_1-0{list-style-type:none}.lst-kix_list_1-4>li{counter-increment:lst-ctn-kix_list_1-4}ol.lst-kix_list_1-1{list-style-type:none}ol.lst-kix_list_1-2{list-style-type:none}ol.lst-kix_list_1-6.start{counter-reset:lst-ctn-kix_list_1-6 0}.lst-kix_list_1-1>li{counter-increment:lst-ctn-kix_list_1-1}ol.lst-kix_list_1-3.start{counter-reset:lst-ctn-kix_list_1-3 0}ol.lst-kix_list_1-2.start{counter-reset:lst-ctn-kix_list_1-2 0}ol.lst-kix_list_1-8.start{counter-reset:lst-ctn-kix_list_1-8 0}.lst-kix_list_1-0>li:before{content:"" counter(lst-ctn-kix_list_1-0,decimal) ") "}ol.lst-kix_list_1-5.start{counter-reset:lst-ctn-kix_list_1-5 0}ol.lst-kix_list_1-7{list-style-type:none}.lst-kix_list_1-1>li:before{content:"" counter(lst-ctn-kix_list_1-1,lower-latin) ". "}.lst-kix_list_1-2>li:before{content:"" counter(lst-ctn-kix_list_1-2,lower-roman) ". "}.lst-kix_list_1-7>li{counter-increment:lst-ctn-kix_list_1-7}ol.lst-kix_list_1-8{list-style-type:none}.lst-kix_list_1-3>li:before{content:"" counter(lst-ctn-kix_list_1-3,decimal) ". "}.lst-kix_list_1-4>li:before{content:"" counter(lst-ctn-kix_list_1-4,lower-latin) ". "}ol.lst-kix_list_1-0.start{counter-reset:lst-ctn-kix_list_1-0 0}.lst-kix_list_1-0>li{counter-increment:lst-ctn-kix_list_1-0}.lst-kix_list_1-6>li{counter-increment:lst-ctn-kix_list_1-6}.lst-kix_list_1-7>li:before{content:"" counter(lst-ctn-kix_list_1-7,lower-latin) ". "}.lst-kix_list_1-3>li{counter-increment:lst-ctn-kix_list_1-3}.lst-kix_list_1-5>li:before{content:"" counter(lst-ctn-kix_list_1-5,lower-roman) ". "}.lst-kix_list_1-6>li:before{content:"" counter(lst-ctn-kix_list_1-6,decimal) ". "}ol.lst-kix_list_1-7.start{counter-reset:lst-ctn-kix_list_1-7 0}.lst-kix_list_1-2>li{counter-increment:lst-ctn-kix_list_1-2}.lst-kix_list_1-5>li{counter-increment:lst-ctn-kix_list_1-5}.lst-kix_list_1-8>li{counter-increment:lst-ctn-kix_list_1-8}ol.lst-kix_list_1-4.start{counter-reset:lst-ctn-kix_list_1-4 0}.lst-kix_list_1-8>li:before{content:"" counter(lst-ctn-kix_list_1-8,lower-roman) ". "}ol.lst-kix_list_1-1.start{counter-reset:lst-ctn-kix_list_1-1 0}ol{margin:0;padding:0}table td,table th{padding:0}.c1{margin-left:36pt;padding-top:0pt;padding-left:0pt;padding-bottom:6pt;line-height:1.15;orphans:2;widows:2;text-align:left}.c3{padding-top:0pt;padding-bottom:6pt;line-height:1.15;orphans:2;widows:2;text-align:center;height:11pt}.c0{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:11pt;font-family:"Calibri";font-style:normal}.c10{color:#000000;font-weight:400;text-decoration:none;vertical-align:super;font-size:11pt;font-family:"Calibri";font-style:normal}.c7{padding-top:0pt;padding-bottom:10pt;line-height:1.1500000000000001;orphans:2;widows:2;text-align:left}.c8{padding-top:0pt;padding-bottom:6pt;line-height:1.15;orphans:2;widows:2;text-align:center}.c4{padding-top:0pt;padding-bottom:6pt;line-height:1.15;orphans:2;widows:2;text-align:left}.c6{background-color:#ffffff;max-width:453.6pt;padding:70.8pt 70.8pt 56.7pt 70.8pt}.c2{padding:0;margin:0}.c9{font-weight:700}.c5{height:11pt}.title{padding-top:24pt;color:#000000;font-weight:700;font-size:36pt;padding-bottom:6pt;font-family:"Calibri";line-height:1.1500000000000001;page-break-after:avoid;orphans:2;widows:2;text-align:left}.subtitle{padding-top:18pt;color:#666666;font-size:24pt;padding-bottom:4pt;font-family:"Georgia";line-height:1.1500000000000001;page-break-after:avoid;font-style:italic;orphans:2;widows:2;text-align:left}li{color:#000000;font-size:11pt;font-family:"Calibri"}p{margin:0;color:#000000;font-size:11pt;font-family:"Calibri"}h1{padding-top:24pt;color:#000000;font-weight:700;font-size:24pt;padding-bottom:6pt;font-family:"Calibri";line-height:1.1500000000000001;page-break-after:avoid;orphans:2;widows:2;text-align:left}h2{padding-top:18pt;color:#000000;font-weight:700;font-size:18pt;padding-bottom:4pt;font-family:"Calibri";line-height:1.1500000000000001;page-break-after:avoid;orphans:2;widows:2;text-align:left}h3{padding-top:14pt;color:#000000;font-weight:700;font-size:14pt;padding-bottom:4pt;font-family:"Calibri";line-height:1.1500000000000001;page-break-after:avoid;orphans:2;widows:2;text-align:left}h4{padding-top:12pt;color:#000000;font-weight:700;font-size:12pt;padding-bottom:2pt;font-family:"Calibri";line-height:1.1500000000000001;page-break-after:avoid;orphans:2;widows:2;text-align:left}h5{padding-top:11pt;color:#000000;font-weight:700;font-size:11pt;padding-bottom:2pt;font-family:"Calibri";line-height:1.1500000000000001;page-break-after:avoid;orphans:2;widows:2;text-align:left}h6{padding-top:10pt;color:#000000;font-weight:700;font-size:10pt;padding-bottom:2pt;font-family:"Calibri";line-height:1.1500000000000001;page-break-after:avoid;orphans:2;widows:2;text-align:left}</style></head><body class="c6"><div><p class="c7"><span>Manuel Schuler &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;19.01.2020&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p></div><p class="c8"><span class="c9">Explanation for QM Project</span></p><p class="c3"><span class="c0"></span></p><p class="c4"><span class="c0">Task: Predict the amount of bikes rented each hour for the days 16-19. The data are in the test sample ?</span></p><p class="c4"><span class="c0">To build the model use the train data (days 1-15). </span></p><p class="c4"><span class="c0">Step by Step Procedure: (make sure you write what you are doing in the report + findings)</span></p><p class="c4"><span class="c0">Find out which variables are relevant. For each variable do the following:</span></p><p class="c4"><span class="c0">Do a regression (Table 1) </span></p><ol class="c2 lst-kix_list_1-0 start" start="1"><li class="c1"><span class="c0">Go into train data</span></li><li class="c1"><span class="c0">Select data, data analysis, regression</span></li><li class="c1"><span class="c0">Select as y the count (M1:M8601 in my case) </span></li><li class="c1"><span class="c0">Select as x input the variable of interest (e.g. I1:I8601 for humidity)</span></li><li class="c1"><span class="c0">Check box: label if your selected column contains a title (e.g. count)</span></li><li class="c1"><span class="c0">Check box: </span><span>Line Fit plots</span></li><li class="c1"><span class="c0">Make sure you select new tabellenblatt)</span></li></ol><p class="c4"><span class="c0">Analyse the result for this variable</span></p><ol class="c2 lst-kix_list_1-0" start="8"><li class="c1"><span class="c0">Look at the R</span><span class="c10">2 </span><span class="c0">(cell B5): no linear relationship if value is about 0.2 or lower</span></li><li class="c1"><span class="c0">Look at the line fit plot whether a linear relationship seems reasonable. </span></li></ol><p class="c4 c5"><span class="c0"></span></p><p class="c4"><span>Pivot Table: You might also want to </span><span class="c0">look at the </span><span class="c0">variable via a pivot table:</span></p><p class="c4 c5"><span class="c0"></span></p><ol class="c2 lst-kix_list_1-0" start="10"><li class="c1"><span class="c0">Select all the train data in the train sample</span></li><li class="c1"><span class="c0">Insert, pivot table (make sure you select &ldquo;New worksheet&rdquo;)</span></li><li class="c1"><span class="c0">Drag the variable you want to know about in the &rdquo;Rows&ldquo; section</span></li><li class="c1"><span class="c0">Drag count in the &ldquo;values&rdquo; section</span></li><li class="c1"><span class="c0">Select the arrow next to &ldquo;values&rdquo;</span></li><li class="c1"><span class="c0">Value Field section, average or sum</span></li><li class="c1"><span class="c0">Can use Pivot graph to display if you prefer a graphic representation</span></li></ol><p class="c4 c5"><span class="c0"></span></p><p class="c4"><span class="c0">Decide which variables are relevant based on the above analysis</span></p><p class="c4 c5"><span class="c0"></span></p><p class="c4"><span class="c0">Time Analysis</span></p><p class="c4 c5"><span class="c0"></span></p><ol class="c2 lst-kix_list_1-0" start="17"><li class="c1"><span class="c0">Do the regression for time</span></li><li class="c1"><span>You will find that </span><span class="c0">Time </span><span class="c0">does not obey linear dependence</span></li><li class="c1"><span class="c0">easiest solution: Do separate regressions for each of the 24 time variables. </span></li><li class="c1"><span>If this is too much work: combine </span><span class="c0">times into time buckets according to similar counts</span><span class="c0">. </span></li><li class="c1"><span class="c0">Suppose you want the following times into 1 basket: times 0:00:00, 01:00:00, 02:00:00, 04:00:00, 05:00:00, because the count is very similar for all these times and we can do 1 regression for all these times. </span></li><li class="c1"><span class="c0">Click any cell in the first row then select filter under data</span></li><li class="c1"><span class="c0">In the time column deselect all and check the times you want to include your first time bucket (see 21)</span></li><li class="c1"><span class="c0">Copy paste only the selection into a new worksheet: &ldquo;Ctrl A&rdquo;, &ldquo;Ctrl C&rdquo;. Add a new worksheet and &ldquo;Ctrl V&rdquo;.</span></li><li class="c1"><span class="c0">Make sure the final variables you want to include are all next to each other</span></li><li class="c1"><span class="c0">&nbsp;Rename Worksheet and do a regression in this worksheet as above. Assuming you have 2000 entries the input y range is M1:M2000. </span></li><li class="c1"><span class="c0">For the input x range include all the variables you want in your final regression model. </span></li><li class="c1"><span class="c0">Example: If atemp and humidity are your independent variables and they are next to each other (have to be) in columns J and K, then input x range is J1:K2000. </span></li><li class="c1"><span class="c0">The R^2 value is in the &ldquo;R square&rdquo; cell. The intercept and the coefficients are also stated in B17, B18, B19. For the example above: count = intercept + atemp-coefficient*atemp + humidity-coefficient*humidity</span></li><li class="c1"><span class="c0">Write down the equation and repeat for your other time buckets</span></li><li class="c1"><span class="c0">For the prediction (test sample) you have to check (using if statements or a lookup table or split the test sample into the time buckets each a different spreadsheet) which time basket the time belongs to and then use the corresponding formula. </span></li><li class="c1"><span class="c0">Some details for the If method: </span></li></ol><p class="c4"><span class="c0">=IF(OR(HOUR(B2)=0;HOUR(B2)=1;HOUR(B2)=2);&quot;Time bucket 1&quot;;&quot;Other time buckets&quot;). This checks which hours are in the first time bucket. Replace &ldquo;Time bucket 1&rdquo; with the formula for the first time bucket. Replace other time buckets with further if statements like above</span></p><ol class="c2 lst-kix_list_1-0" start="33"><li class="c1"><span class="c0">Some details on Splitting test sample into the corresponding times of your time bucket: insert the formula in 29) for count. Finally you might want to combine the different worksheets into one. </span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 312.26px; height: 242.03px;"><img alt="" src="images/image1.png" style="width: 312.26px; height: 242.03px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></li></ol><p class="c4 c5"><span class="c0"></span></p><p class="c4 c5"><span class="c0"></span></p><p class="c4"><span>Table 1</span></p></body></html>